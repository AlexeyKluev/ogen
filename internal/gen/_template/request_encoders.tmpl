{{- /*gotype: github.com/ogen-go/ogen/internal/gen.TemplateConfig*/ -}}
{{ define "request_encoders" }}
{{ $pkg := $.Package }}
{{ template "header" $ }}

{{/* Range over all methods */}}
{{- range $m := $.Methods }}
{{- if $m.RequestType }}
func encode{{ $m.Name }}Request(req {{ $m.RequestType.Type }}) (data []byte, contentType string, err error) {
    {{- $requestsLength := len $m.RequestBody.Contents }}
    {{- if eq $requestsLength 1 }}
    {{- range $ctype, $schema := $m.RequestBody.Contents }}

    {{- if eq $ctype "application/json" }}
    return req.encodeJSON(), "{{ $ctype }}", nil
    {{- else }}
    return nil, "", fmt.Errorf("{{ $ctype }} encoder not implemented")
    {{- end }}

    {{- end }}
    {{- else }}
    {{- /* Multiple requests */}}
    switch req := req.(type) {
    {{- range $ctype, $schema := $m.RequestBody.Contents }}
    case *{{ $schema.Type }}:
        {{- if eq $ctype "application/json" }}
        return req.encodeJSON(), "{{ $ctype }}", nil
        {{- else }}
        return nil, "", fmt.Errorf("{{ $ctype }} encoder not implemented")
        {{- end }}
    {{- end }}
    default:
        return nil, "", fmt.Errorf("unexpected request type: %T", req)
    }
    {{- end }}
}
{{- end }}
{{ end }}
{{/* Range over all methods */}}

{{ end }}
